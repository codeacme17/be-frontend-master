## React 中的 DOM 更新策略

React 的 DOM 更新策略旨在提高应用性能，确保用户界面高效且响应迅速地反映底层数据的变化。React 通过虚拟 DOM 和一些列的智能算法来最小化对真实 DOM 的操作

### 虚拟 DOM

- 核心概念

  React 使用虚拟 DOM（Virtual DOM）作为真实 DOM 的轻量级表示。虚拟 DOM 是一个简单的 Javascript 对象，它描述了真实 DOM 的结构。当组件状态变化时，React 会创建一个新的虚拟 DOM 树，并将其与前一个虚拟 DOM 树进行比较

- Diff 算法

  React 的 Diff 算法负责比较新旧虚拟 DOM 树的差异（这个过程称为 “reconciliation”）。React 通过比较树的每个节点，找出需要更新的部分。React 的 Diff 算法通过三个策略优化性能：

  - 树级别的比较

  - 组件级别的比较

  - 元素级别的比较

### 组件更新

- 组件生命周期

  React 组件的生命周期方法（如 `shouldComponentUpdate`）允许开发者控制组件是否需要重新渲染，进一步优化性能。通过跳过不必要的更新可以减少虚拟 DOM 的比较和重新渲染的工作量

- Keys

  在处理动态元素列表时，通过给每个列表元素分配一个唯一的 `key` 属性，React 可以更快的识别和匹配虚拟 DOM 树中的元素，这对于提高列表渲染的性能非常关键

### 异步渲染（Concurrent Mode）

- Concurrent Mode

  React 的 CM 是一个实验性特性，它允许 React 在渲染时更加智能的安排工作，通过将渲染工作分割成小块并利用浏览器的空闲时间来执行，可以大幅提升应用的响应性和性能。这种模式使得 React 可以在长时间渲染过程中仍然保持应用的响应性

### 批量更新

- 事件处理和批量更新

  React 通过批量更新机制来优化性能，挡在 React 事件处理函数中多次更改状态时，React 会将这些状态更新聚合到一起，在事件处理完成后一次性更新，从而减少不必要的渲染次数
