## 宏任务和微任务分别有哪些

宏任务 (Macro Tasks) 和微任务 (Micro Tasks) 是 Javascript 中用于管理异步操作的概念，他们有着不同的特点和执行顺序

### 宏任务

- 定时器任务 (`setTimeout`、`setInterval`)：通过制定的时间间隔触发

- I/O 操作任务 (Node)：涉及文件、网络 I/O 操作的任务

- DOM 渲染任务 (Browser)：浏览器进行页面渲染的任务

- UI 交互事件任务 (Browser)：用户与页面进行交互时触发的任务，如点击、滚动等事件

- 执行完整的 Javascript 脚本任务：包括通过 `<script>` 标签引入的脚本执行

### 微任务

- `Promise` 的回调函数：通过 `resolve` 或 `reject` 触发的回调函数

- `MutationObserver` 的回调函数 (Browser)：观察 DOM 变化并触发的回调函数

- `process.nextTick` (Node)：Nodejs 中的微任务，用于在当前执行阶段结束后执行

### 浏览器环境异步任务执行步骤

1. 先执行一个宏任务
2. 检查是否有微任务，如果有则依次执行所有微任务
3. 更新渲染
4. 执行下一个宏任务（从宏任务队列中取出）

### Node 环境异步任务执行步骤

1. 执行微任务：在同步代码执行完成后，Nodejs 会立即执行所有微任务
2. 执行下一个宏任务：在执行完微任务后，Nodejs 会从宏任务队列中选择一个宏任务进行执行
   > 宏任务执行优先级：I/O -> 定时器 -> `setImmediate` -> 事件回调
3. 执行微任务：在宏任务执行过程中，如果产生了新的微任务，Node 会立即执行这些微任务
